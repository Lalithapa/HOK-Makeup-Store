{% if swatch == blank %}
  <div class="swatch error">
    <p>Swatches Error</p>
  </div>
{% else %}
  {% assign found_option = false %}
  {% assign first_variant = product.selected_or_first_available_variant %}
  {% assign is_color = false %}
  {% assign option_index = 0 %}
  {% for option in product.options limit: 2 %}
    {% if option == swatch %}
      {% assign found_option = true %}
      {% assign option_index = forloop.index0 %}
      {% assign downcased_option = swatch | downcase %}
      {% if downcased_option contains 'color' or downcased_option contains 'colour' %}
        {% assign is_color = true %}
      {% endif %}
    {% endif %}
  {% endfor %}
  {% unless found_option %}
    <div class="swatch error">
      <p>Add color as swatch in code</p>
    </div>
  {% else %}
    <div class="swtach_container position-relative">
      <div
        class="pockets swatch variantHandler{% unless template contains 'collection' or template contains 'search' %} collec{% endunless %}"
        swiper_slider="{{ product.id | append: section.id | remove: '-' |  remove: '_'  }}"
        data-option-index="{{ indexIs }}"
      >
        <div class="d-flex">
          {% assign values = '' %}
          {% for variant in product.variants %}
            {% assign value = variant.options[option_index] %}
            {% assign index0 = forloop.index0 %}
            {% unless values contains value %}
              {% assign values = values | join: ',' %}
              {% assign values = values | append: ',' | append: value %}
              {% assign values = values | split: ',' %}
              <div
                data-value="{{ value | escape }}"
                class="swatch-element{% if isrecommend  %} w-auto mx-1{% endif %} {% if is_color %} color{% endif %} {{ isrecommend }}"
              >
                <input
                  type="radio"
                  id="swatch-{{ section.id |  remove: '-' |  remove: '_' }}-{{ variant.id }}-{% if isAdvertisement %}{{ random_number | plus: 1 }}{% else %}{{ product.handle | append: value | modulo: 100 | plus: 1 }}{% endif %}"
                  boxIndex="{{ index0 }}"
                  index="{{ indexIs }}"
                  title="{{ value | handle  }}"
                  imgSource="{{ variant.featured_image | image_url }}"
                  variantId="{{ value | handle }}"
                  value="{{  variant.id }}"
                  variantPrice="{{ variant.price | money_without_trailing_zeros }}"
                  variantRackRate="{{ variant.compare_at_price | money_without_trailing_zeros }}"
                  is_variant_available="{% if variant.available %}true{% else %}false{% endif %}"
                  name="{{ product.id | append: section.id | remove: '-' |  remove: '_' }}-{% if isAdvertisement %}{{ random_number | plus: 1 }}{% else %}{{ product.handle | append: value | modulo: 100 | plus: 1 }}{% endif %}"
                  {% if first_variant.option1 == value %}
                    checked
                  {% endif %}
                >
                {% if is_color %}
                  <label
                    for="swatch-{{ section.id |  remove: '-' |  remove: '_' }}-{{ variant.id }}-{% if isAdvertisement %}{{ random_number | plus: 1 }}{% else %}{{ product.handle | append: value | modulo: 100 | plus: 1 }}{% endif %}"
                    class="circular_swatch {% if variant.available %}available{% else %}b-swatch_colors-item m-disabled{% endif %}"
                    style="
                      {% if isrecommend %}width:23px!important;height:23px!important;{% endif %}
                      {% if product.variants[forloop.index0].metafields.custom.colour != blank %}
                            background-color:{{ product.variants[forloop.index0].metafields.custom.colour }} !important;
                            {% else %} background-image: url('{% if variant.metafields.custom.variant_image != blank %}{{ variant.metafields.custom.variant_image | image_url }} {% else %}{{ variant.featured_image | image_url }}{% endif %}');
                            {% endif %}
                    "
                  >
                  </label>
                {% else %}
                  <label for="swatch-{{ indexIs }}-{{ value | handle }}">
                    {{ value }}
                    <img
                      width="100%"
                      height="100%"
                      class="crossed-out"
                      src="{{ 'soldout.png' | asset_url }}"
                      title="{{ value | handle  }}"
                    >
                  </label>
                {% endif %}
              </div>
            {% endunless %}
          {% endfor %}
        </div>
      </div>
      {% comment %} {% unless handleRecommendSec %}
        {% if product.variants.size >= 4 %}
          <div class="arrow_handler navigationArrow">
            <div
              id="carousel-prev-{{ product.id | append: section.id | remove: '-' |  remove: '_' }}"
              class="swatch_arrows"
            >
              {{ 'arrow-back.svg' | inline_asset_content }}
            </div>
            <div
              id="carousel-next-{{ product.id | append: section.id | remove: '-' |  remove: '_' }}"
              class="swatch_arrows"
              aria-disabled="false"
            >
              {{ 'arrow-next.svg' | inline_asset_content }}
            </div>
          </div>
        {% endif %}
      {% endunless %} {% endcomment %}
    </div>
  {% endunless %}
{% endif %}